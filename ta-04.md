Here's a **backend technical assessment** that meets your requirements.

---

### **Technical Assessment: TA-02 â€” User Feedback API**

#### âœ… **Level**: Easy

#### âœ… **Language**: TypeScript

#### âœ… **Stack**: Node.js + Express (+ MongoDB Optional)

#### âœ… **Format**: Real-world scenario

#### âœ… **Objective**: Build an API to accept and validate user feedback.

---

## ğŸ“ Scenario

You are developing a feedback collection service for a web application. Users submit feedback containing their email, a rating (1â€“5), and an optional message.

Youâ€™ve been provided a partially implemented Node.js + Express backend that exposes a POST endpoint at `/api/feedback`.

Your task is to:

* Validate incoming data (email, rating, message).
* Store or return the data (storage is mocked).
* Write test cases for edge conditions.
* Follow best practices.

---

## ğŸ“ File Structure

```
/feedback-api/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app.ts
â”‚   â”œâ”€â”€ routes/feedback.ts
â”‚   â”œâ”€â”€ controllers/feedbackController.ts
â”‚   â””â”€â”€ utils/validators.ts
â”œâ”€â”€ tests/
â”‚   â””â”€â”€ feedback.test.ts
â”œâ”€â”€ package.json
â””â”€â”€ tsconfig.json
```

---

## âœ… Partially Completed Code

### **`src/app.ts`**

```ts
import express from 'express';
import feedbackRouter from './routes/feedback';

const app = express();
app.use(express.json());
app.use('/api/feedback', feedbackRouter);

export default app;
```

---

### **`src/routes/feedback.ts`**

```ts
import { Router } from 'express';
import { submitFeedback } from '../controllers/feedbackController';

const router = Router();

router.post('/', submitFeedback);

export default router;
```

---

### **`src/controllers/feedbackController.ts`**

```ts
import { Request, Response } from 'express';
import { isValidEmail, isValidRating } from '../utils/validators';

export function submitFeedback(req: Request, res: Response) {
    const { email, rating, message } = req.body;

    // âœ… TODO: validate input
    // 1. Check email format
    // 2. Check rating is number between 1-5
    // 3. Message can be optional but if present, must be < 500 characters

    // TBD

    return res.status(201).json({
        message: 'Feedback submitted successfully',
        data: { email, rating, message },
    });
}
```

---

### **`src/utils/validators.ts`**

```ts
export function isValidEmail(email: string): boolean {
    const regex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    return regex.test(email);
}

export function isValidRating(rating: number): boolean {
    return Number.isInteger(rating) && rating >= 1 && rating <= 5;
}
```

---

## âœ… Requirements to Implement

* In `submitFeedback`:

  * Reject requests missing `email` or `rating`.
  * Return 400 if email or rating is invalid.
  * Limit message to 500 characters max.
  * Trim and sanitize inputs.

---

## âœ… Jest Test Cases: **`tests/feedback.test.ts`**

```ts
import request from 'supertest';
import app from '../src/app';

describe('POST /api/feedback', () => {
    it('should accept valid feedback', async () => {
        const res = await request(app)
            .post('/api/feedback')
            .send({
                email: 'test@example.com',
                rating: 5,
                message: 'Great product!',
            });

        expect(res.status).toBe(201);
        expect(res.body.data.email).toBe('test@example.com');
    });

    it('should reject missing email', async () => {
        const res = await request(app)
            .post('/api/feedback')
            .send({ rating: 4 });

        expect(res.status).toBe(400);
    });

    it('should reject invalid email format', async () => {
        const res = await request(app)
            .post('/api/feedback')
            .send({ email: 'not-an-email', rating: 3 });

        expect(res.status).toBe(400);
    });

    it('should reject rating outside range', async () => {
        const res = await request(app)
            .post('/api/feedback')
            .send({ email: 'user@example.com', rating: 7 });

        expect(res.status).toBe(400);
    });

    it('should reject message longer than 500 chars', async () => {
        const res = await request(app)
            .post('/api/feedback')
            .send({
                email: 'test@example.com',
                rating: 4,
                message: 'x'.repeat(501),
            });

        expect(res.status).toBe(400);
    });
});
```

---

## âš ï¸ Edge Cases to Handle

* Rating must be an integer (not a float like `3.5`)
* Email with extra spaces should be trimmed
* Email should be case-insensitive
* Message is optional but if present, max 500 chars
* JSON with additional unexpected fields should be ignored (donâ€™t crash)

---

## âœ… Best Practices

* Use strict input validation
* Sanitize and normalize inputs (e.g., trim email)
* Respond with appropriate HTTP codes (400 for bad input, 201 for success)
* Keep controllers thin and validators modular
* Use meaningful error messages

---
